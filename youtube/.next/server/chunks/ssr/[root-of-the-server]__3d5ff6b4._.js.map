{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 111, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/krish/OneDrive/Documents/YOUTUBE/youtube/src/app/upload/page.jsx"],"sourcesContent":[" \"use client\"\r\n import React, { useState } from 'react';\r\n import { useEffect } from 'react';\r\n import { useSession } from 'next-auth/react';\r\n import axios from 'axios';\r\n\r\n const UploadForm = () => {\r\n\r\n const [selectedFile, setSelectedFile] = useState(null);\r\n const [title, setTitle] = useState('');\r\n const [description, setDescription] = useState('');\r\n const [author, setAuthor] = useState('');\r\n\r\n const handleFileChange = (e) => {\r\n setSelectedFile(e.target.files[0]);\r\n };\r\n\r\n  const {data} = useSession();\r\n useEffect(() => {\r\n console.log('data-------', data);\r\n if(!data) {\r\n console.log('redirecting');\r\n redirect(\"/\");\r\n }\r\n }, [])\r\n\r\n\r\n const handleUpload = async () => {\r\n\r\n if (!title || !author) {\r\n alert('Title and Author are required fields.');\r\n return;\r\n }\r\n\r\n try {\r\n\r\n const formData = new FormData();\r\n formData.append('filename', selectedFile.name); //appending only filename\r\n\r\n const initializeRes = await axios.post('http://localhost:8080/upload/initialize',\r\n formData, {\r\n headers: {\r\n 'Content-Type': 'multipart/form-data'\r\n }\r\n }\r\n );\r\n const { uploadId } = initializeRes.data;\r\n console.log('Upload id is ', uploadId);    //part---1\r\n\r\n\r\n //part---2\r\n const chunkSize = 5 * 1024 * 1024; // 5 MB chunks\r\n\r\n const totalChunks = Math.ceil(selectedFile.size / chunkSize);\r\n\r\n let start = 0;\r\nconst uploadPromises = [];\r\n for (let chunkIndex = 0; chunkIndex < totalChunks; chunkIndex++) {\r\n\r\n const chunk = selectedFile.slice(start, start + chunkSize);\r\n\r\n start += chunkSize;\r\n\r\nconst chunkFormData = new FormData();\r\n\r\n chunkFormData.append('filename', selectedFile.name);\r\n chunkFormData.append('chunk', chunk);\r\n chunkFormData.append('totalChunks', totalChunks);\r\n chunkFormData.append('chunkIndex', chunkIndex);\r\n chunkFormData.append('uploadId', uploadId);\r\n\r\n const uploadPromise = axios.post('http://localhost:8080/upload', chunkFormData, {\r\n headers: {\r\n 'Content-Type': 'multipart/form-data'\r\n }\r\n });\r\n uploadPromises.push(uploadPromise);\r\n\r\n }\r\n await Promise.all(uploadPromises);\r\n\r\n //part-----3\r\n const completeRes = await axios.post('http://localhost:8080/upload/complete', {\r\n filename: selectedFile.name,\r\n totalChunks: totalChunks,\r\n uploadId: uploadId,\r\ntitle: title,\r\n description: description,\r\n author: author\r\n });\r\n console.log(completeRes.data);\r\n } catch (error) {\r\n console.error('Error uploading file:', error);\r\n }\r\n };\r\n\r\n\r\n\r\n return (\r\n <div className='container mx-auto max-w-lg p-10'>\r\n <form encType=\"multipart/form-data\">\r\n <div className=\"mb-4\">\r\n <input type=\"text\"\r\n name=\"title\"\r\n placeholder=\"Title\"\r\n value={title}\r\n onChange={(e) => setTitle(e.target.value)}\r\n required\r\n className=\"px-3 py-2 w-full border rounded-md focus:outline-none\r\n focus:border-blue-500\" />\r\n </div>\r\n <div className=\"mb-4\">\r\n <input type=\"text\"\r\n name=\"description\"\r\n placeholder=\"Description\"\r\n value={description}\r\n onChange={(e) => setDescription(e.target.value)}\r\nclassName=\"px-3 py-2 w-full border rounded-md focus:outline-none\r\n focus:border-blue-500\" />\r\n </div>\r\n <div className=\"mb-4\">\r\n <input type=\"text\"\r\n name=\"author\"\r\n placeholder=\"Author\"\r\n value={author}\r\n onChange={(e) => setAuthor(e.target.value)}\r\n required\r\n className=\"px-3 py-2 w-full border rounded-md focus:outline-none\r\n focus:border-blue-500\" />\r\n </div>\r\n <div className=\"mb-4\">\r\n <input type=\"file\"\r\n name=\"file\"\r\n onChange={handleFileChange}\r\n className=\"px-3 py-2 w-full border rounded-md focus:outline-none\r\n focus:border-blue-500\" />\r\n </div>\r\n <button\r\n type=\"button\"\r\n onClick={handleUpload}\r\n className=\"text-white bg-gradient-to-br from-purple-600 to-blue-500\r\n hover:bg-gradient-to-bl focus:ring-4 focus:outline-none focus:ring-blue-300\r\n dark:focus:ring-blue-800 font-medium rounded-lg text-sm px-5 py-2.5 text-center\"\r\n >\r\n Upload\r\n </button>\r\n </form>\r\n </div>\r\n );\r\n };\r\nexport default UploadForm"],"names":[],"mappings":"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","debugId":null}}]
}